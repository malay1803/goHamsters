<%- include('partials/head') %> <%- include('partials/nav') %>

<style>
  .addItems{
    color: white;
    text-decoration: none;
  }
  .addFoodItem{
    background-color: #f05454;
  }
  th,td{
    text-align: center;
  }
</style>

<div class="container col-lg-12 col-md-12 col-sm-12 mt-5">
  <div class="row" style="height: 4em">
    <div
      class="hello h-100 d-flex justify-content-end align-items-center pe-5"
      style="background-color: #30475e; border-radius: 2em"
    >
      <div class="h4 align-middle text-end" style="color: white">
        Hello,<%=userName%>
      </div>
    </div>
  </div>
  <div class="row mt-2 ">
    <div
      class="col-md-3 shadow order-1 p-4"
      style="background-color: #30475e; border-radius: 2em"
    >
      <div class="rounded userImgDiv w-100 text-center pt-4 pb-3">
        <img
          class="rounded-circle z-depth-2"
          alt="100x100"
          src="/images/defaultUser.jpg"
          style="width: 6em"
        />
      </div>
      <div class="userDetails d-flex justify-content-center">
        <table
          class="table w-75"
          style="border: none; background-color: #f5f5f5"
        >
          <tr class="w-50">
            <th class="text-end">Username:</th>
            <th>User's Name</th>
          </tr>
          <tr class="w-50">
            <th class="text-end">Email:</th>
            <th>user@email.com</th>
          </tr>
          <tr class="w-50">
            <th class="text-end">Time:</th>
            <th>user@email.com</th>
          </tr>
        </table>
      </div>
      <div class="editProfile mb-4">
        <div class="h6 text-center">
          <a href="" style="color: #f5f5f5; text-decoration: none"
            >Edit Profile</a
          >
        </div>
      </div>
    </div>

    <div class="col-md-9 order-2 charts p-4">
      <div class="row">
        <div class="col-md-4 text-center">
          <canvas class="donutChart" id="donutChart"></canvas>
        </div>
        <div class="col-md-8 text-center">
          <canvas class="lineChart" id="lineChart"></canvas>
        </div>
      </div>
    </div>

    <div class="col-md-3 order-3 mt-2">
      <div class="analyticsDiv w-100">
        <button type="submit" class="showAnalytics w-100" style="background-color: #30475e; border-radius: 2em; color: #fff;">Show Analytics</button>
      </div>
      <div class="trackerDiv w-100 mt-2">
        <button type="submit" class="showTracker w-100" style="background-color: #30475e; border-radius: 2em; color: #fff;">Show Calorie Tracker</button>
      </div>
    </div>

    <div class="col-md-9 order-4 mt-2">
      <!-- <div class="totalText">Total</div> -->
      <table class="table totalTable">
        <thead>
          <tr>
            <th>Total calories</th>
            <th>Total carbohydrate</th>
            <th>Total fat</th>
            <th>Total protein</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>1</td>
            <td>1</td>
            <td>1</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="col-md-9 order-2 foodSearch p-4" style="overflow-y: scroll; max-height: 350px;">
      <div class="row">
        <div class="col-md-9 mx-auto">
          <div class="h3 text-uppercase">Track your calories</div>
          <form action="/search" method="post">
            <input type="text" class="search w-100 rounded p-2" name="searchQuery" id="searchQuery">
            <button type="submit" class="mt-3 p-2 rounded" style="background-color: #30475e; color: white; border: none;">Search Food</button>
          </form>
          <!-- <hr> -->
          <table class="my-3 table table-bordered">
            <thead>
              <tr>
                <th>Name</th>
                <th>Calories</th>
                <th>Carbohydrates</th>
                <th>Fat</th>
                <th>Protein</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                
                <td><%= foodName%></td>
                <td><%=calories%></td>
                <td><%=carbs%></td>
                <td><%=fat%></td>
                <td><%=protein%></td>
              </tr>
            </tbody>
          </table>
          <div class="addItemsDiv w-100">
            <div class="row">
              <input type="text" class="addItemsInput w-100 rounded p-1" name="addItemsInput" placeholder="Enter grams intake(default 100)"></input>
            </div>
            <div class="row d-flex justify-content-around mt-3">
              <select name="foodTime" class="w-50" id="foodTime">
                <option value="breakfast">Breakfast</option>
                <option value="lunch">Lunch</option>
                <option value="dinner">Dinner</option>
                <option value="snacks">Snacks</option>
              </select>
              <button class="addFoodItem rounded w-25" type="button" onclick="addItems()"> <a href="/addItem" class="addItems w-100 h-100 h6">Add items</a> </button>
            </div>
          </div>
          <hr>
          <div class="breakfastDiv w-100">
            <div class="h5">Breakfast</div>
            <ul class="list-group d-flex justify-content-around w-100" id="breakfastList">
              
            </ul>
          </div>
          <hr>
          <div class="breakfastDiv d-flex justify-content-between w-100">
            <div class="h5">Lunch</div>
          </div>
          <hr>
          <div class="breakfastDiv d-flex justify-content-between w-100">
            <div class="h5">Dinner</div>
          </div>
          <hr>
          <div class="breakfastDiv d-flex justify-content-between w-100">
            <div class="h5">Snacks</div>
          </div>
        </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>

  // breakfast list 

  function addItems(){
    event.preventDefault();
    let foodTIme = $("#foodTime").val() 
    if (foodTIme==="breakfast"){
      $("#breakfastList").append(`<li class="list-group-item h6">butter chicken 
              <div class="remEdit">
                <a href="" style="text-decoration: none; color: #f05454; font-size: .8em;">remove</a>
                <div class="vr"></div>
                <a href="" style="text-decoration: none; color: #f05454; font-size: .8em">edit intake(gms)</a>
              </div>
              </li>`)
    }
    // alert(foodTIme)
  }

// show analytics/tracker
$(".charts").hide()

$(".showTracker").on("click", ()=>{
  $(".charts").hide()
  $(".foodSearch").fadeToggle()
})

$(".showAnalytics").on("click", ()=>{
  $(".foodSearch").hide()
  $(".charts").fadeIn()
})

// ------charts--------- 
  var doughnutChart = document.getElementById("donutChart").getContext("2d");
  var lineChart = document.getElementById("donutChart").getContext("2d");

  var myDoughnutChart = new Chart(doughnutChart, {
    type: "doughnut",
    data: {
      labels: ["Red", "Blue", "Yellow"],
      datasets: [
        {
          label: "My First Dataset",
          data: [300, 50, 100],
          backgroundColor: [
            "rgb(255, 99, 132)",
            "rgb(54, 162, 235)",
            "rgb(255, 205, 86)",
          ],
          hoverOffset: 4,
        },
      ],
    },
  });

  var xValues = [50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150];
  var yValues = [7, 8, 8, 9, 9, 9, 10, 11, 14, 14, 15];
  const labels = 1;
  new Chart("lineChart", {
    type: "line",
    data: {
      labels: xValues,
      datasets: [
        {
          label: "My First Dataset",
          data: [65, 59, 80, 81, 56, 55, 40],
          fill: false,
          borderColor: "rgb(75, 192, 192)",
          tension: 0.1,
        },
      ],
    },
  });
</script>

<a href="/logout">Logout</a>
<a href="/directory">Directory</a>
